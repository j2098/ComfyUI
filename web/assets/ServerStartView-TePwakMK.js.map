{"version":3,"file":"ServerStartView-TePwakMK.js","sources":["../../src/views/ServerStartView.vue"],"sourcesContent":["<template>\n  <BaseViewTemplate dark class=\"flex-col\">\n    <h2 class=\"text-2xl font-bold\">\n      {{ t(`serverStart.process.${status}`) }}\n      <span v-if=\"status === ProgressStatus.ERROR\">\n        v{{ electronVersion }}\n      </span>\n    </h2>\n    <div\n      v-if=\"status === ProgressStatus.ERROR\"\n      class=\"flex flex-col items-center gap-4\"\n    >\n      <div class=\"flex items-center my-4 gap-2\">\n        <Button\n          icon=\"pi pi-flag\"\n          severity=\"secondary\"\n          :label=\"t('serverStart.reportIssue')\"\n          @click=\"reportIssue\"\n        />\n        <Button\n          icon=\"pi pi-file\"\n          severity=\"secondary\"\n          :label=\"t('serverStart.openLogs')\"\n          @click=\"openLogs\"\n        />\n        <Button\n          icon=\"pi pi-refresh\"\n          :label=\"t('serverStart.reinstall')\"\n          @click=\"reinstall\"\n        />\n      </div>\n      <Button\n        v-if=\"!terminalVisible\"\n        icon=\"pi pi-search\"\n        severity=\"secondary\"\n        :label=\"t('serverStart.showTerminal')\"\n        @click=\"terminalVisible = true\"\n      />\n    </div>\n    <BaseTerminal v-show=\"terminalVisible\" @created=\"terminalCreated\" />\n  </BaseViewTemplate>\n</template>\n\n<script setup lang=\"ts\">\nimport { ProgressStatus } from '@comfyorg/comfyui-electron-types'\nimport { Terminal } from '@xterm/xterm'\nimport Button from 'primevue/button'\nimport { Ref, onMounted, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport BaseTerminal from '@/components/bottomPanel/tabs/terminal/BaseTerminal.vue'\nimport type { useTerminal } from '@/hooks/bottomPanelTabs/useTerminal'\nimport { electronAPI } from '@/utils/envUtil'\nimport BaseViewTemplate from '@/views/templates/BaseViewTemplate.vue'\n\nconst electron = electronAPI()\nconst { t } = useI18n()\n\nconst status = ref<ProgressStatus>(ProgressStatus.INITIAL_STATE)\nconst electronVersion = ref<string>('')\nlet xterm: Terminal | undefined\n\nconst terminalVisible = ref(true)\n\nconst updateProgress = ({ status: newStatus }: { status: ProgressStatus }) => {\n  status.value = newStatus\n\n  // Make critical error screen more obvious.\n  if (newStatus === ProgressStatus.ERROR) terminalVisible.value = false\n  else xterm?.clear()\n}\n\nconst terminalCreated = (\n  { terminal, useAutoSize }: ReturnType<typeof useTerminal>,\n  root: Ref<HTMLElement>\n) => {\n  xterm = terminal\n\n  useAutoSize(root, true, true)\n  electron.onLogMessage((message: string) => {\n    terminal.write(message)\n  })\n\n  terminal.options.cursorBlink = false\n  terminal.options.disableStdin = true\n  terminal.options.cursorInactiveStyle = 'block'\n}\n\nconst reinstall = () => electron.reinstall()\nconst reportIssue = () => {\n  window.open('https://forum.comfy.org/c/v1-feedback/', '_blank')\n}\nconst openLogs = () => electron.openLogsFolder()\n\nonMounted(async () => {\n  electron.sendReady()\n  electron.onProgressUpdate(updateProgress)\n  electronVersion.value = await electron.getElectronVersion()\n})\n</script>\n\n<style scoped>\n:deep(.xterm-helper-textarea) {\n  /* Hide this as it moves all over when uv is running */\n  display: none;\n}\n</style>\n"],"names":[],"mappings":"80BAuDA,MAAM,SAAW,cACX,CAAE,GAAM,UAER,OAAS,IAAoB,eAAe,aAAa,EACzD,gBAAkB,IAAY,EAAE,EAClC,IAAA,MAEE,MAAA,gBAAkB,IAAI,EAAI,EAE1B,eAAiB,QAAC,CAAE,OAAQ,aAA4C,CAC5E,OAAO,MAAQ,UAGX,YAAc,eAAe,MAAO,gBAAgB,MAAQ,UACpD,MAAM,CAAA,EALG,kBAQjB,gBAAkB,QACtB,CAAE,SAAU,WAAA,EACZ,OACG,CACK,MAAA,SAEI,YAAA,KAAM,GAAM,EAAI,EACnB,SAAA,aAAc,SAAoB,CACzC,SAAS,MAAM,OAAO,CAAA,CACvB,EAED,SAAS,QAAQ,YAAc,GAC/B,SAAS,QAAQ,aAAe,GAChC,SAAS,QAAQ,oBAAsB,OAAA,EAbjB,mBAgBlB,UAAY,WAAM,SAAS,YAAf,aACZ,YAAc,WAAM,CACjB,OAAA,KAAK,yCAA0C,QAAQ,CAAA,EAD5C,eAGd,SAAW,WAAM,SAAS,iBAAf,YAEjB,iBAAU,SAAY,CACpB,SAAS,UAAU,EACnB,SAAS,iBAAiB,cAAc,EACxB,gBAAA,MAAQ,MAAM,SAAS,mBAAmB,CAAA,CAC3D"}