var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{d as defineComponent,aX as useUserStore,c0 as useRouter,ab as ref,c as computed,m as onMounted,o as openBlock,k as createBlock,M as withCtx,H as createBaseVNode,X as toDisplayString,N as createVNode,c1 as withKeys,j as unref,av as script,bT as script$1,c2 as script$2,c3 as script$3,aE as createTextVNode,I as createCommentVNode,l as script$4}from"./index-OxMKI-_9.js";import{_ as _sfc_main$1}from"./BaseViewTemplate-CHmaYIdG.js";const _hoisted_1={id:"comfy-user-selection",class:"min-w-84 relative rounded-lg bg-[var(--comfy-menu-bg)] p-5 px-10 shadow-lg"},_hoisted_2=createBaseVNode("h1",{class:"my-2.5 mb-7 font-normal"},"ComfyUI",-1),_hoisted_3={class:"flex w-full flex-col items-center"},_hoisted_4={class:"flex w-full flex-col gap-2"},_hoisted_5={for:"new-user-input"},_hoisted_6={class:"flex w-full flex-col gap-2"},_hoisted_7={for:"existing-user-select"},_hoisted_8={class:"mt-5"},_sfc_main=defineComponent({__name:"UserSelectView",setup(__props){const userStore=useUserStore(),router=useRouter(),selectedUser=ref(null),newUsername=ref(""),loginError=ref(""),createNewUser=computed(()=>newUsername.value.trim()!==""),newUserExistsError=computed(()=>userStore.users.find(user=>user.username===newUsername.value)?`User "${newUsername.value}" already exists`:""),error=computed(()=>newUserExistsError.value||loginError.value),login=__name(async()=>{try{const user=createNewUser.value?await userStore.createUser(newUsername.value):selectedUser.value;if(!user)throw new Error("No user selected");userStore.login(user),router.push("/")}catch(err){loginError.value=err.message??JSON.stringify(err)}},"login");return onMounted(async()=>{userStore.initialized||await userStore.initialize()}),(_ctx,_cache)=>(openBlock(),createBlock(_sfc_main$1,{dark:""},{default:withCtx(()=>[createBaseVNode("main",_hoisted_1,[_hoisted_2,createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("label",_hoisted_5,toDisplayString(_ctx.$t("userSelect.newUser"))+":",1),createVNode(unref(script),{id:"new-user-input",modelValue:newUsername.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>newUsername.value=$event),placeholder:_ctx.$t("userSelect.enterUsername"),onKeyup:withKeys(login,["enter"])},null,8,["modelValue","placeholder"])]),createVNode(unref(script$1)),createBaseVNode("div",_hoisted_6,[createBaseVNode("label",_hoisted_7,toDisplayString(_ctx.$t("userSelect.existingUser"))+":",1),createVNode(unref(script$2),{modelValue:selectedUser.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>selectedUser.value=$event),class:"w-full",inputId:"existing-user-select",options:unref(userStore).users,"option-label":"username",placeholder:_ctx.$t("userSelect.selectUser"),disabled:createNewUser.value},null,8,["modelValue","options","placeholder","disabled"]),error.value?(openBlock(),createBlock(unref(script$3),{key:0,severity:"error"},{default:withCtx(()=>[createTextVNode(toDisplayString(error.value),1)]),_:1})):createCommentVNode("",!0)]),createBaseVNode("footer",_hoisted_8,[createVNode(unref(script$4),{label:_ctx.$t("userSelect.next"),onClick:login},null,8,["label"])])])])]),_:1}))}});export{_sfc_main as default};
//# sourceMappingURL=UserSelectView-5HjUJanF.js.map
