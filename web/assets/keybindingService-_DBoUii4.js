var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{ao as useKeybindingStore,J as useCommandStore,a as useSettingStore,dz as KeyComboImpl,dA as KeybindingImpl}from"./index-C5iPCN6D.js";const CORE_KEYBINDINGS=[{combo:{ctrl:!0,key:"Enter"},commandId:"Comfy.QueuePrompt"},{combo:{ctrl:!0,shift:!0,key:"Enter"},commandId:"Comfy.QueuePromptFront"},{combo:{ctrl:!0,alt:!0,key:"Enter"},commandId:"Comfy.Interrupt"},{combo:{key:"r"},commandId:"Comfy.RefreshNodeDefinitions"},{combo:{key:"q"},commandId:"Workspace.ToggleSidebarTab.queue"},{combo:{key:"w"},commandId:"Workspace.ToggleSidebarTab.workflows"},{combo:{key:"n"},commandId:"Workspace.ToggleSidebarTab.node-library"},{combo:{key:"m"},commandId:"Workspace.ToggleSidebarTab.model-library"},{combo:{key:"s",ctrl:!0},commandId:"Comfy.SaveWorkflow"},{combo:{key:"o",ctrl:!0},commandId:"Comfy.OpenWorkflow"},{combo:{key:"Backspace"},commandId:"Comfy.ClearWorkflow"},{combo:{key:"g",ctrl:!0},commandId:"Comfy.Graph.GroupSelectedNodes"},{combo:{key:",",ctrl:!0},commandId:"Comfy.ShowSettingsDialog"},{combo:{key:"=",alt:!0},commandId:"Comfy.Canvas.ZoomIn",targetElementId:"graph-canvas"},{combo:{key:"+",alt:!0,shift:!0},commandId:"Comfy.Canvas.ZoomIn",targetElementId:"graph-canvas"},{combo:{key:"+",alt:!0},commandId:"Comfy.Canvas.ZoomIn",targetElementId:"graph-canvas"},{combo:{key:"-",alt:!0},commandId:"Comfy.Canvas.ZoomOut",targetElementId:"graph-canvas"},{combo:{key:"."},commandId:"Comfy.Canvas.FitView",targetElementId:"graph-canvas"},{combo:{key:"p"},commandId:"Comfy.Canvas.ToggleSelected.Pin",targetElementId:"graph-canvas"},{combo:{key:"c",alt:!0},commandId:"Comfy.Canvas.ToggleSelectedNodes.Collapse",targetElementId:"graph-canvas"},{combo:{key:"b",ctrl:!0},commandId:"Comfy.Canvas.ToggleSelectedNodes.Bypass",targetElementId:"graph-canvas"},{combo:{key:"m",ctrl:!0},commandId:"Comfy.Canvas.ToggleSelectedNodes.Mute",targetElementId:"graph-canvas"},{combo:{key:"`",ctrl:!0},commandId:"Workspace.ToggleBottomPanelTab.logs-terminal"},{combo:{key:"f"},commandId:"Workspace.ToggleFocusMode"}],useKeybindingService=__name(()=>{const keybindingStore=useKeybindingStore(),commandStore=useCommandStore(),settingStore=useSettingStore(),keybindHandler=__name(async function(event){const keyCombo=KeyComboImpl.fromEvent(event);if(keyCombo.isModifier)return;const target=event.composedPath()[0];if(!keyCombo.hasModifier&&(target.tagName==="TEXTAREA"||target.tagName==="INPUT"||target.tagName==="SPAN"&&target.classList.contains("property_value")))return;const keybinding=keybindingStore.getKeybinding(keyCombo);if(keybinding&&keybinding.targetElementId!=="graph-canvas"){event.preventDefault(),await commandStore.execute(keybinding.commandId);return}if(!(event.ctrlKey||event.altKey||event.metaKey)&&event.key==="Escape"){const modals=document.querySelectorAll(".comfy-modal");for(const modal of modals)if(window.getComputedStyle(modal).getPropertyValue("display")!=="none"){modal.style.display="none";break}for(const d of document.querySelectorAll("dialog"))d.close()}},"keybindHandler"),registerCoreKeybindings=__name(()=>{for(const keybinding of CORE_KEYBINDINGS)keybindingStore.addDefaultKeybinding(new KeybindingImpl(keybinding))},"registerCoreKeybindings");function registerUserKeybindings(){const unsetBindings=settingStore.get("Comfy.Keybinding.UnsetBindings");for(const keybinding of unsetBindings)keybindingStore.unsetKeybinding(new KeybindingImpl(keybinding));const newBindings=settingStore.get("Comfy.Keybinding.NewBindings");for(const keybinding of newBindings)keybindingStore.addUserKeybinding(new KeybindingImpl(keybinding))}__name(registerUserKeybindings,"registerUserKeybindings");async function persistUserKeybindings(){await settingStore.set("Comfy.Keybinding.NewBindings",Object.values(keybindingStore.getUserKeybindings())),await settingStore.set("Comfy.Keybinding.UnsetBindings",Object.values(keybindingStore.getUserUnsetKeybindings()))}return __name(persistUserKeybindings,"persistUserKeybindings"),{keybindHandler,registerCoreKeybindings,registerUserKeybindings,persistUserKeybindings}},"useKeybindingService");export{useKeybindingService as u};
//# sourceMappingURL=keybindingService-_DBoUii4.js.map
