var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{d as defineComponent,ab as ref,ct as FilterMatchMode,cy as useExtensionStore,a as useSettingStore,m as onMounted,c as computed,o as openBlock,k as createBlock,M as withCtx,N as createVNode,cu as SearchBox,j as unref,c3 as script,H as createBaseVNode,f as createElementBlock,E as renderList,X as toDisplayString,aE as createTextVNode,F as Fragment,l as script$1,I as createCommentVNode,aI as script$3,b7 as script$4,ca as script$5,cv as _sfc_main$1}from"./index-DFddlmOC.js";import{s as script$2,a as script$6}from"./index-C5ho4SqD.js";import"./index-BAXOiInM.js";import"./index-DwueGf1G.js";const _hoisted_1={class:"flex justify-end"},_sfc_main=defineComponent({__name:"ExtensionPanel",setup(__props){const filters=ref({global:{value:"",matchMode:FilterMatchMode.CONTAINS}}),extensionStore=useExtensionStore(),settingStore=useSettingStore(),editingEnabledExtensions=ref({});onMounted(()=>{extensionStore.extensions.forEach(ext=>{editingEnabledExtensions.value[ext.name]=extensionStore.isExtensionEnabled(ext.name)})});const changedExtensions=computed(()=>extensionStore.extensions.filter(ext=>editingEnabledExtensions.value[ext.name]!==extensionStore.isExtensionEnabled(ext.name))),hasChanges=computed(()=>changedExtensions.value.length>0),updateExtensionStatus=__name(()=>{const editingDisabledExtensionNames=Object.entries(editingEnabledExtensions.value).filter(([_,enabled])=>!enabled).map(([name])=>name);settingStore.set("Comfy.Extension.Disabled",[...extensionStore.inactiveDisabledExtensionNames,...editingDisabledExtensionNames])},"updateExtensionStatus"),enableAllExtensions=__name(()=>{extensionStore.extensions.forEach(ext=>{extensionStore.isExtensionReadOnly(ext.name)||(editingEnabledExtensions.value[ext.name]=!0)}),updateExtensionStatus()},"enableAllExtensions"),disableAllExtensions=__name(()=>{extensionStore.extensions.forEach(ext=>{extensionStore.isExtensionReadOnly(ext.name)||(editingEnabledExtensions.value[ext.name]=!1)}),updateExtensionStatus()},"disableAllExtensions"),disableThirdPartyExtensions=__name(()=>{extensionStore.extensions.forEach(ext=>{extensionStore.isCoreExtension(ext.name)||(editingEnabledExtensions.value[ext.name]=!1)}),updateExtensionStatus()},"disableThirdPartyExtensions"),applyChanges=__name(()=>{window.location.reload()},"applyChanges"),menu=ref(),contextMenuItems=[{label:"Enable All",icon:"pi pi-check",command:enableAllExtensions},{label:"Disable All",icon:"pi pi-times",command:disableAllExtensions},{label:"Disable 3rd Party",icon:"pi pi-times",command:disableThirdPartyExtensions,disabled:!extensionStore.hasThirdPartyExtensions}];return(_ctx,_cache)=>(openBlock(),createBlock(_sfc_main$1,{value:"Extension",class:"extension-panel"},{header:withCtx(()=>[createVNode(SearchBox,{modelValue:filters.value.global.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>filters.value.global.value=$event),placeholder:_ctx.$t("g.searchExtensions")+"..."},null,8,["modelValue","placeholder"]),hasChanges.value?(openBlock(),createBlock(unref(script),{key:0,severity:"info","pt:text":"w-full",class:"max-h-96 overflow-y-auto"},{default:withCtx(()=>[createBaseVNode("ul",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(changedExtensions.value,ext=>(openBlock(),createElementBlock("li",{key:ext.name},[createBaseVNode("span",null,toDisplayString(unref(extensionStore).isExtensionEnabled(ext.name)?"[-]":"[+]"),1),createTextVNode(" "+toDisplayString(ext.name),1)]))),128))]),createBaseVNode("div",_hoisted_1,[createVNode(unref(script$1),{label:_ctx.$t("g.reloadToApplyChanges"),onClick:applyChanges,outlined:"",severity:"danger"},null,8,["label"])])]),_:1})):createCommentVNode("",!0)]),default:withCtx(()=>[createVNode(unref(script$6),{value:unref(extensionStore).extensions,stripedRows:"",size:"small",filters:filters.value},{default:withCtx(()=>[createVNode(unref(script$2),{header:_ctx.$t("g.extensionName"),sortable:"",field:"name"},{body:withCtx(slotProps=>[createTextVNode(toDisplayString(slotProps.data.name)+" ",1),unref(extensionStore).isCoreExtension(slotProps.data.name)?(openBlock(),createBlock(unref(script$3),{key:0,value:"Core"})):createCommentVNode("",!0)]),_:1},8,["header"]),createVNode(unref(script$2),{pt:{headerCell:"flex items-center justify-end",bodyCell:"flex items-center justify-end"}},{header:withCtx(()=>[createVNode(unref(script$1),{icon:"pi pi-ellipsis-h",text:"",severity:"secondary",onClick:_cache[1]||(_cache[1]=$event=>menu.value.show($event))}),createVNode(unref(script$4),{ref_key:"menu",ref:menu,model:contextMenuItems},null,512)]),body:withCtx(slotProps=>[createVNode(unref(script$5),{disabled:unref(extensionStore).isExtensionReadOnly(slotProps.data.name),modelValue:editingEnabledExtensions.value[slotProps.data.name],"onUpdate:modelValue":__name($event=>editingEnabledExtensions.value[slotProps.data.name]=$event,"onUpdate:modelValue"),onChange:updateExtensionStatus},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value","filters"])]),_:1}))}});export{_sfc_main as default};
//# sourceMappingURL=ExtensionPanel-BsGdCHdO.js.map
